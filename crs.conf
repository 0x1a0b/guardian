#
# -=[ XSS Filters - Category 2 ]=-
# XSS vectors making use of event handlers like onerror, onload etc, e.g., <body onload="alert(1)">
#
#SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* "@rx (?i)[\s\"'`;\/0-9=\x0B\x09\x0C\x3B\x2C\x28\x3B]+on[a-zA-Z]+[\s\x0B\x09\x0C\x3B\x2C\x28\x3B]*?=" \
#    "id:941120,\
#    phase:2,\
#    block,\
#    capture,\
#    t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,\
#    msg:'XSS Filter - Category 2: Event Handler Vector',\
#    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
#    tag:'application-multi',\
#    tag:'language-multi',\
#    tag:'platform-multi',\
#    tag:'attack-xss',\
#    tag:'paranoia-level/1',\
#    tag:'OWASP_CRS',\
#    tag:'OWASP_CRS/WEB_ATTACK/XSS',\
#    tag:'WASCTC/WASC-8',\
#    tag:'WASCTC/WASC-22',\
#    tag:'OWASP_TOP_10/A3',\
#    tag:'OWASP_AppSensor/IE1',\
#    tag:'CAPEC-242',\
#    ctl:auditLogParts=+E,\
#    ver:'OWASP_CRS/3.2.0',\
#    severity:'CRITICAL',\
#    setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\
#    setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}'"

SecRule QUERY_STRING|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer "@rx (?i)[\s\"'`;\/0-9=\x0B\x09\x0C\x3B\x2C\x28\x3B]+on[a-zA-Z]+[\s\x0B\x09\x0C\x3B\x2C\x28\x3B]*?=" \
    "id:941120,\
    phase:2,\
    block,\
    capture,\
    t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,\
    msg:'XSS Filter - Category 2: Event Handler Vector',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-xss',\
    tag:'paranoia-level/1',\
    tag:'OWASP_CRS',\
    tag:'OWASP_CRS/WEB_ATTACK/XSS',\
    tag:'WASCTC/WASC-8',\
    tag:'WASCTC/WASC-22',\
    tag:'OWASP_TOP_10/A3',\
    tag:'OWASP_AppSensor/IE1',\
    tag:'CAPEC-242',\
    ctl:auditLogParts=+E,\
    ver:'OWASP_CRS/3.2.0',\
    severity:'CRITICAL',\
    setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\
    setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}'"


SecRule QUERY_STRING "@detectXSS" "id:12345,log,deny"
SecRule QUERY_STRING "@validateByteRange 1-255" "id:179"
SecRule AUTH_TYPE "Basic" "id:14"

#
# -=[ XSS Filters - Category 3 ]=-
#
#SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|ARGS_NAMES|ARGS|XML:/* "@rx (?i)[\s\S]((?:x(?:link:href|html|mlns)|!ENTITY.*?(?:SYSTEM|PUBLIC)|data:text\/html|formaction|\@import|base64)\b|pattern\b.*?=)" \
#    "id:941130,\
#    phase:2,\
#    block,\
#    capture,\
#    t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,\
#    msg:'XSS Filter - Category 3: Attribute Vector',\
#    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
#    tag:'application-multi',\
#    tag:'language-multi',\
#    tag:'platform-multi',\
#    tag:'attack-xss',\
#    tag:'paranoia-level/1',\
#    tag:'OWASP_CRS',\
#    tag:'OWASP_CRS/WEB_ATTACK/XSS',\
#    tag:'WASCTC/WASC-8',\
#    tag:'WASCTC/WASC-22',\
#    tag:'OWASP_TOP_10/A3',\
#    tag:'OWASP_AppSensor/IE1',\
#    tag:'CAPEC-242',\
#    ctl:auditLogParts=+E,\
#    ver:'OWASP_CRS/3.2.0',\
#    severity:'CRITICAL',\
#    setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\
#    setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}'"

